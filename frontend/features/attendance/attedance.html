<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VITB Smashers - Attendance Calculator</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="attendance.css">

</head>
<body>
    <!-- Header with Menu Toggle -->
    <header class="header">
        <div class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
        
        <div class="logo">
            <img src="../images/logo.png" alt="VITB Smashers Logo">
            <div class="logo-text">
                <h1>VITB Smashers</h1>
                <span>Attendance Calculator</span>
            </div>
        </div>
        
        <div class="header-actions">
            <div class="user-profile">
                <div class="user-avatar">
                    <i class='bx bxs-user'></i>
                </div>
                <div class="user-name">Student</div>
            </div>
        </div>
    </header>
    
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-title">Main Navigation</div>
        <ul class="sidebar-menu">
            <!-- <li><a href="#"><i class='bx bxs-dashboard'></i> Dashboard</a></li> -->
            <li><a href="../profile/profile.html"><i class='bx bxs-user'></i> Profile</a></li>
            <li><a href="../attendance/attedance.html" class="active"><i class='bx bxs-calculator'></i> Attendance Calculator</a></li>
            <li><a href="../gpa-calculator/cgpa.html"><i class='bx bxs-calculator'></i> CGPA Calculator</a></li>
            <li><a href="../ttmaker/ttmaker1.html"><i class='bx bxs-calendar'></i> Timetable Maker</a></li>
        </ul>
        
        <div class="sidebar-title">Resources</div>
        <ul class="sidebar-menu">
            <li><a href="../marketplace/market.html"><i class='bx bxs-store'></i> Marketplace</a></li>
            <li><a href="../club/club.html" ><i class='bx bxs-group'></i> Club Info</a></li>
            <li><a href="../faculty/faculty.html" ><i class='bx bxs-group'></i> Faculty Info</a></li>
            <li><a href="../mess-menu/mess.html"><i class='bx bxs-food-menu'></i> Mess Menus</a></li>
        </ul>
        
        <div class="sidebar-title">Quick Links</div>
        <ul class="sidebar-menu">
            <li><a href="../mycourses/mycourses.html"><i class='bx bxs-graduation'></i> My Courses</a></li>
            <li><a href="../event/event.html"><i class='bx bxs-calendar-event'></i> Events</a></li>
        </ul>
        
        <div class="sidebar-title">Account</div>
        <ul class="sidebar-menu">
            <li><a href="#"><i class='bx bxs-cog'></i> Settings</a></li>
            <li><a href="#"><i class='bx bxs-log-out'></i> Logout</a></li>
        </ul>
    </nav>    
    <main class="main-content" id="mainContent">
        <h1 class="page-title">
            <i class='bx bxs-calculator'></i> Attendance Calculator
        </h1>
        
        <div class="attendance-container">
            <div class="input-section">
                <h2 class="section-title">
                    <i class='bx bxs-edit-alt'></i> Enter Attendance Details
                </h2>
                
                <div class="form-group">
                    <label>Subject Name (Optional)</label>
                    <input type="text" class="form-control" id="subjectName" placeholder="e.g. Data Structures & Algorithms">
                    <small style="display: block; margin-top: 8px; color: #aaa;">Leave blank for default naming</small>
                </div>
                
                <div class="form-group">
                    <label>Total Classes Held</label>
                    <input type="number" class="form-control" id="totalClasses" min="1" placeholder="Enter total classes">
                </div>
                
                <div class="form-group">
                    <label>Classes Attended</label>
                    <input type="number" class="form-control" id="attendedClasses" min="0" placeholder="Enter classes attended">
                </div>
                
                <div class="actions">
                    <button class="btn btn-warning" id="calculateBtn">
                        <i class='bx bx-calculator'></i> Calculate
                    </button>
                    <button class="btn btn-primary" id="saveSubject">
                        <i class='bx bx-save'></i> Save Subject
                    </button>
                    <button class="btn btn-outline" id="resetForm">
                        <i class='bx bx-reset'></i> Reset Form
                    </button>
                </div>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">
                    <i class='bx bxs-calendar-check'></i> Attendance Results
                </h2>
                
                <div class="attendance-result" id="attendanceResult">
                    <div class="result-title">Current Calculation</div>
                    <div class="attendance-percentage" id="attendancePercentage">0%</div>
                    <div class="attendance-status" id="attendanceStatus">Enter values to calculate</div>
                    
                    <div class="result-details">
                        <div class="detail-card">
                            <div>Required for 75%</div>
                            <div class="detail-value" id="requiredClasses">0</div>
                            <div>Classes to attend</div>
                        </div>
                        <div class="detail-card">
                            <div>Can Miss</div>
                            <div class="detail-value" id="allowedAbsences">0</div>
                            <div>Classes safely</div>
                        </div>
                    </div>
                </div>
                
                <h3 class="section-title">
                    <i class='bx bxs-book'></i> Saved Subjects
                    <span class="subject-count" id="subjectCount">0</span>
                </h3>
                
                <div class="subject-list" id="subjectList">
                    <div class="empty-state">
                        <i class='bx bx-bookmark-alt'></i>
                        <p>No subjects saved yet</p>
                        <p>Add your first subject to track attendance</p>
                    </div>
                </div>
                
                <div class="actions">
                    <button class="btn btn-outline" id="clearAll">
                        <i class='bx bx-trash'></i> Clear All Subjects
                    </button>
                </div>
            </div>
        </div>
        
        <div class="calculator-tips">
            <h3 class="tips-title">
                <i class='bx bxs-bulb'></i> Attendance Tips for VIT Students
            </h3>
            <ul class="tips-list">
                <li>VIT requires a minimum of 75% attendance in each subject to be eligible for exams</li>
                <li>Aim for 80% attendance to have a buffer for unexpected absences</li>
                <li>Track your attendance regularly to avoid last-minute surprises</li>
                <li>Communicate with professors if you need to miss classes for valid reasons</li>
                <li>Prioritize attendance in subjects with strict faculty policies</li>
                <li>Use this calculator to plan your attendance strategy effectively</li>
            </ul>
        </div>
    </main>

    <script>
        // Toggle sidebar
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });
        
        document.addEventListener('click', (e) => {
            if (sidebar.classList.contains('active') && 
                !sidebar.contains(e.target) && 
                !menuToggle.contains(e.target)) {
                sidebar.classList.remove('active');
            }
        });
const subjectNameInput = document.getElementById('subjectName');
const totalClassesInput = document.getElementById('totalClasses');
const attendedClassesInput = document.getElementById('attendedClasses');
const calculateBtn = document.getElementById('calculateBtn');
const saveSubjectBtn = document.getElementById('saveSubject');
const resetFormBtn = document.getElementById('resetForm');
const clearAllBtn = document.getElementById('clearAll');
const attendancePercentage = document.getElementById('attendancePercentage');
const attendanceStatus = document.getElementById('attendanceStatus');
const requiredClasses = document.getElementById('requiredClasses');
const allowedAbsences = document.getElementById('allowedAbsences');
const subjectList = document.getElementById('subjectList');
const subjectCount = document.getElementById('subjectCount');

let subjects = [];

function loadSubjects() {
    const saved = localStorage.getItem('attendanceSubjects');
    if (saved) {
        subjects = JSON.parse(saved);
        renderSubjects();
    }
}

function saveSubjects() {
    localStorage.setItem('attendanceSubjects', JSON.stringify(subjects));
}

function renderSubjects() {
    subjectList.innerHTML = '';
    subjectCount.textContent = subjects.length;
    
    if (subjects.length === 0) {
        subjectList.innerHTML = `
            <div class="empty-state">
                <i class='bx bx-bookmark-alt'></i>
                <p>No subjects saved yet</p>
                <p>Add your first subject to track attendance</p>
            </div>
        `;
        return;
    }
    
    subjects.forEach((subject, index) => {
        const item = document.createElement('div');
        item.className = 'subject-item';
        
        let statusColor = '';
        if (subject.percentage >= 75) {
            statusColor = 'color: var(--success-color);';
        } else if (subject.percentage >= 65) {
            statusColor = 'color: var(--warning-color);';
        } else {
            statusColor = 'color: var(--secondary-color);';
        }
        
        item.innerHTML = `
            <div class="subject-info">
                <div class="subject-name">${subject.name}</div>
                <div class="subject-stats">
                    <span>${subject.attended} / ${subject.total} classes</span>
                    <span style="${statusColor}">${subject.percentage}%</span>
                </div>
            </div>
            <div class="subject-actions">
                <button class="action-btn edit-btn" data-index="${index}">
                    <i class='bx bx-edit'></i>
                </button>
                <button class="action-btn delete-btn" data-index="${index}">
                    <i class='bx bx-trash'></i>
                </button>
            </div>
        `;
        subjectList.appendChild(item);
    });
    
    document.querySelectorAll('.edit-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            editSubject(index);
        });
    });
    
    document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const index = this.getAttribute('data-index');
            deleteSubject(index);
        });
    });
}

function editSubject(index) {
    const subject = subjects[index];
    subjectNameInput.value = subject.name;
    totalClassesInput.value = subject.total;
    attendedClassesInput.value = subject.attended;
    
    calculateAttendance();
    
    subjects.splice(index, 1);
    saveSubjects();
    renderSubjects();
}

function deleteSubject(index) {
    subjects.splice(index, 1);
    saveSubjects();
    renderSubjects();
}

function calculateAttendance() {
    const totalClasses = parseInt(totalClassesInput.value);
    const attendedClasses = parseInt(attendedClassesInput.value);
    
    if (isNaN(totalClasses) || totalClasses <= 0) {
        alert('Please enter a valid number for total classes');
        totalClassesInput.focus();
        return;
    }
    
    if (isNaN(attendedClasses) || attendedClasses < 0) {
        alert('Please enter a valid number for classes attended');
        attendedClassesInput.focus();
        return;
    }
    
    if (attendedClasses > totalClasses) {
        alert('Attended classes cannot be more than total classes');
        attendedClassesInput.value = '';
        attendedClassesInput.focus();
        return;
    }
    
    const percentage = (attendedClasses / totalClasses) * 100;
    attendancePercentage.textContent = percentage.toFixed(1) + '%';
    
    attendancePercentage.style.transform = 'scale(1.1)';
    setTimeout(() => {
        attendancePercentage.style.transform = 'scale(1)';
    }, 300);
    
    if (percentage >= 75) {
        attendanceStatus.textContent = 'Good Standing';
        attendanceStatus.className = 'attendance-status status-safe';
    } else if (percentage >= 65) {
        attendanceStatus.textContent = 'Warning - Close to Minimum';
        attendanceStatus.className = 'attendance-status status-warning';
    } else {
        attendanceStatus.textContent = 'Danger - Below Requirement';
        attendanceStatus.className = 'attendance-status status-danger';
    }
    
    const requiredFor75 = Math.max(0, 3 * totalClasses - 4 * attendedClasses);
    requiredClasses.textContent = requiredFor75;
    
    const maxConsecutiveMisses = Math.floor((attendedClasses / 0.75) - totalClasses);
    allowedAbsences.textContent = maxConsecutiveMisses > 0 ? maxConsecutiveMisses : 0;
    
    return { total: totalClasses, attended: attendedClasses, percentage: percentage.toFixed(1) };
}

function saveSubject() {
    const subjectData = calculateAttendance();
    if (!subjectData) return;
    
    let subjectName = subjectNameInput.value.trim();
    if (!subjectName) {
        const subjectCount = subjects.length + 1;
        subjectName = `Subject ${subjectCount}`;
    }
    
    if (subjects.some(sub => sub.name === subjectName)) {
        alert('A subject with this name already exists. Please use a different name.');
        return;
    }
    
    subjects.push({
        name: subjectName,
        total: subjectData.total,
        attended: subjectData.attended,
        percentage: subjectData.percentage
    });
    
    saveSubjects();
    renderSubjects();
    
    resetForm();
    
    attendanceStatus.textContent = 'Subject saved successfully!';
    attendanceStatus.className = 'attendance-status status-safe';
    setTimeout(() => {
        attendanceStatus.textContent = 'Enter values to calculate';
        attendanceStatus.className = 'attendance-status';
    }, 2000);
}

function resetForm() {
    subjectNameInput.value = '';
    totalClassesInput.value = '';
    attendedClassesInput.value = '';
    attendancePercentage.textContent = '0%';
    requiredClasses.textContent = '0';
    allowedAbsences.textContent = '0';
    attendanceStatus.textContent = 'Enter values to calculate';
    attendanceStatus.className = 'attendance-status';
}

function clearAllSubjects() {
    if (subjects.length === 0) return;
    
    if (confirm('Are you sure you want to delete all saved subjects?')) {
        subjects = [];
        saveSubjects();
        renderSubjects();
    }
}

calculateBtn.addEventListener('click', calculateAttendance);
saveSubjectBtn.addEventListener('click', saveSubject);
resetFormBtn.addEventListener('click', resetForm);
clearAllBtn.addEventListener('click', clearAllSubjects);

loadSubjects();  
    </script>
</body>
</html>
